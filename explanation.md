>修改后的代码与源代码主要有2个地方不同，一是函数定义，二是全局变量
# 1，函数
函数我改了两个地方。
第一个是因为原函数定义中的参数arg在函数内部没被使用，有没有好像是一样的，但形参好像会一样被存在内存里，所以就把他删了。
第二个是我把malloc函数删了。因为动态分配内存是需要对堆区域进行操作的，但申请的时候是随机的，也就是说不太好利用缓存的局部性，但栈区通常是连续的。而且先用malloc申请空间，再用指针给空间赋值，跟直接定义一个int变量在将指针指向那个变量得到的结果是一致的，于是乎我就改成后者了(而且可以用具体数据证明，如图)![](<屏幕截图 2024-10-16 183606.png>)
>ps：好像小明malloc那句写错了，改成int \*ptr = (int\*)malloc(sizeof(int));
另外，题目里提到的爆栈问题，我想应该可能还是用到了malloc函数，但添加了if语句。具体如下
```cpp
void function(int arg) {
    int localVar = 20;
    int *ptr = malloc(sizeof(int));
    if (ptr == NULL){
    return ;
    }
    *ptr = 30;
    free(ptr);
}
```

# 2，全局变量
我将三个全局的常量，指针，变量放到main函数内变为局部，缩短了它们的生命周期（但好像也没什么缩短，因为程序主题就是main，从main开始到return结束，没改的时候这三者好像也只存在了这么长时间，而且我用上面那个函数测得没什么差别）

---
>而且在测试的时候还发现了一个奇怪的现象![](<屏幕截图 2024-10-16 184511.png>)
同一个程序的每次返回的值不一样，不知道是什么原因。但误差都在±0.000010内浮动，而1中的差值很明显，说明是有差异的，而2中的就无法通过这个程序说明了。
（这个现象我猜有可能是本身程序运行的时间就存在一定的误差，不知道对不对）